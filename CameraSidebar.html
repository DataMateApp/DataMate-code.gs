<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body { font-family: Arial, sans-serif; padding: 10px; }
      label { display: block; margin: 10px 0 5px; }
      select, input { width: 100%; padding: 5px; margin-bottom: 10px; }
      button { width: 100%; padding: 10px; background-color: #4CAF50; color: white; border: none; cursor: pointer; }
      button:hover { background-color: #45a049; }
    </style>
  </head>
  <body>
    <h2>ðŸ“¸ Camera Tool</h2>

    <label for="sourceSheet">Source Sheet:</label>
    <select id="sourceSheet"></select>

    <label for="sourceRange">Source Range (e.g. A1:D5):</label>
    <input type="text" id="sourceRange" placeholder="A1:D5">

    <label for="targetSheet">Target Sheet:</label>
    <select id="targetSheet"></select>

    <label for="targetCell">Target Start Cell (e.g. H1):</label>
    <input type="text" id="targetCell" placeholder="H1">

    <button onclick="createSnapshot()">ðŸ“· Create Snapshot</button>

    <script>
      // Populate sheet dropdowns
      google.script.run
        .withSuccessHandler(function(sheetNames) {
          const source = document.getElementById('sourceSheet');
          const target = document.getElementById('targetSheet');
          sheetNames.forEach(name => {
            const option1 = document.createElement('option');
            const option2 = document.createElement('option');
            option1.text = option2.text = name;
            source.add(option1);
            target.add(option2);
          });
        })
        .getSheetNames();

      // Create snapshot and save config
      function createSnapshot() {
        const data = {
          sourceSheet: document.getElementById('sourceSheet').value,
          sourceRange: document.getElementById('sourceRange').value,
          targetSheet: document.getElementById('targetSheet').value,
          targetCell: document.getElementById('targetCell').value
        };
        google.script.run
          .withSuccessHandler(function() {
            alert('Snapshot created and will sync automatically!');
          })
          .withFailureHandler(function(error) {
            alert('Error: ' + error.message);
          })
          .copyCameraSnapshot(data);
      }
    </script>
  </body>
</html>
